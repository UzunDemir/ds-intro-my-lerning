# Рассмотрите вопросы, которые часто встречаются на собеседованиях в коммерческой сфере, на примере собеседований по блоку Airflow. 

Попробуйте ответить на них самостоятельно, а затем оцените себя по готовому ответу.

Всего вы разберёте семь вопросов.

## Вопрос 1
Как бы вы описали Airflow? Какие проблемы он решает?

## *Ответ 1*

Apache Airflow — инструмент с открытым исходным кодом, который используется для оркестрации рабочего процесса, например, извлечения, преобразования и загрузки данных (ETL). Airflow позволяет писать, планировать и регулировать рабочие процессы через встроенный пользовательский интерфейс. 

Некоторые преимущества Airflow, помогающие в решении проблем:

ведение журнала каждой выполненной задачи;

масштабируемость в соответствии с природой события;

создание и поддержка связи между задачами;

создание пользовательского интерфейса, который отслеживает и контролирует выполнение рабочего процесса.

Airflow отлично подходит для задачи, если она состоит из выгрузки данных из одного источника (например, с веб-сайта), обработки данных (создания новых колонок, удаления ненужных признаков) и загрузки этих данных в новый источник (рабочую базу данных), а рабочий процесс запускается в определённое время (каждый день в 03:00). 

Может показаться, что для этой задачи оркестратор не нужен, но с увеличением данных и усложнением аналитических задач увеличивается и число ETL-процессов, которые необходимо планировать, отслеживать и отлаживать. Таким образом, возникает необходимость в оркестраторе.

## Вопрос 2
Как в Airflow определяются рабочие процессы?

## *Ответ 2*
Рабочие процессы в Apache Airflow — это набор зависящих друг от друга задач. Airflow использует ориентированные ациклические графы (DAG) для представления рабочего процесса. 

Задачи представлены как узел графа, а зависимости между ними представлены как рёбра графа. Графы являются ациклическими, чтобы избежать циклических зависимостей, которые вызывают, например, бесконечные циклы.

Простой пример: Airflow определяет четыре задачи (A, B, C и D), указывает порядок, в котором они должны выполняться, и зависимость между ними. Также Airflow задаёт частоту запуска DAG (например, «каждый день, начиная с завтрашнего дня, в 13:00» или «каждый понедельник с 1 января 2022 года, в 14:00»).

## Вопрос 3
Какие компоненты использует Airflow?

## *Ответ 3*

![image](https://user-images.githubusercontent.com/94790150/219961961-bc31a681-c1b5-4f27-ac86-8ab2d5ab3520.png)

Архитектура Apache Airflow состоит из:

Scheduler (планировщик) заботится как о запуске рабочих процессов в запланированное время, так и о передаче задач в Executor.
Executor (исполнитель) — внутренний компонент планировщика; заботится о текущих задачах. Запускает все процессы внутри планировщика, тесно с ним сотрудничает, чтобы выяснить, какие ресурсы будут выделены на задачи, когда они поставлены в очередь.
Веб-сервер Airflow (Web UI) — пользовательский интерфейс Airflow, который проверяет поведение DAG и зависимости задач.
Базы хранения метаданных сохраняют записи обо всех задачах DAG и их статусе (в очереди/запланировано/выполняется/успешно/не удалось и так далее).
Workers — это процессы, которые выполняют задачи; определяются используемым исполнителем. Workers несут ответственность за фактическое выполнение задачи.
Журналы выполнения задач (Task Execution Logs) — часть веб-интерфейса. Заполняются рабочими процессами (workers) и хранятся либо на диске, либо в удалённом файловом хранилище. Веб-сервер получает доступ к журналам и делает их доступными для веб-интерфейса.

## Вопрос 4
Можете ли вы объяснить разницу между задачей и оператором?

## *Ответ 4*
Задача — это определённая единица работы, которая выполняется оператором. Оператор — это класс, который принимает задачу и выполняет её.

## Вопрос 5
Как вы можете запустить сценарий bash в задаче Airflow?

## *Ответ 5*
Вы можете запустить файл сценария bash, используя BashOperator:

create_command = """
 ./scripts/create_file.sh
"""
bash_task = BashOperator(
    task_id= 'create_file',
    bash_command=create_command,
    dag=dag
)

## Вопрос 6
Что такое cron? Для чего он нужен?

## *Ответ 6*
Cron — это задание, выполнение которого запланировано в определённое время или интервал. Задания Cron обычно используются для автоматизации повторяющихся действий, таких как запуск определённого сценария.

## Вопрос 7
Каков формат заданий в Cron? Какая команда будет запускать действие каждый час? Какая команда будет запускать действие каждые шесть часов?

## *Ответ 7*
Чтобы настроить задание Cron для запуска несколько раз в день, вам нужно открыть файл crontab и добавить новую строку для каждого запуска. Формат каждой строки будет следующим:

минута   час   день_месяца   месяц   день_недели

Например, если вы хотите запускать задание каждый час, вы должны использовать следующую строку:

0 * * * *

Если вы хотите запускать задание каждые шесть часов, вы должны использовать следующую строку:

0 */6 * * * [(Cron job every 6 hours)](https://crontab.guru/every-6-hours)

